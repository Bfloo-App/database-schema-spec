{
  "database": {
    "engine": "PostgreSQL",
    "version": "15.0"
  },
  "schema": {
    "id": "f47ac10b-58cc-4372-a567-0e02b2c3d479",
    "name": "Healthcare Management System",
    "snapshot": {
      "id": "456def78-9abc-45e6-f789-012345678901",
      "label": "v3.2.1",
      "description": "Comprehensive healthcare management with patient records and appointments",
      "parent_id": "8a2e8f50-b29c-42d4-a817-556644330001",
      "created_at": "2024-05-15T09:20:00"
    },
    "tables": [
      {
        "id": 1,
        "name": "patients",
        "description": "Patient information and medical records",
        "columns": [
          {
            "id": 1,
            "name": "id",
            "type": "serial",
            "constraints": {
              "nullable": false,
              "primary_key": true
            }
          },
          {
            "id": 2,
            "name": "patient_number",
            "type": "text",
            "constraints": {
              "nullable": false,
              "unique": true,
              "max_length": {
                "name": "max_patient_number_length",
                "value": 12
              }
            }
          },
          {
            "id": 3,
            "name": "first_name",
            "type": "text",
            "constraints": {
              "nullable": false,
              "min_length": {
                "name": "min_first_name_length",
                "value": 1
              },
              "max_length": {
                "name": "max_first_name_length",
                "value": 80
              }
            }
          },
          {
            "id": 4,
            "name": "last_name",
            "type": "text",
            "constraints": {
              "nullable": false,
              "min_length": {
                "name": "min_last_name_length",
                "value": 1
              },
              "max_length": {
                "name": "max_last_name_length",
                "value": 80
              }
            }
          },
          {
            "id": 5,
            "name": "date_of_birth",
            "type": "date",
            "constraints": {
              "nullable": false
            }
          },
          {
            "id": 6,
            "name": "gender",
            "type": "text",
            "default": null,
            "constraints": {
              "max_length": {
                "name": "max_gender_length",
                "value": 10
              }
            }
          },
          {
            "id": 7,
            "name": "phone",
            "type": "text",
            "default": null,
            "constraints": {
              "min_length": {
                "name": "min_phone_length",
                "value": 10
              },
              "max_length": {
                "name": "max_phone_length",
                "value": 15
              }
            }
          },
          {
            "id": 8,
            "name": "email",
            "type": "text",
            "constraints": {
              "max_length": {
                "name": "max_email_length",
                "value": 150
              }
            }
          },
          {
            "id": 9,
            "name": "emergency_contact",
            "type": "text",
            "default": null,
            "constraints": {
              "max_length": {
                "name": "max_emergency_contact_length",
                "value": 100
              }
            }
          },
          {
            "id": 10,
            "name": "blood_type",
            "type": "text",
            "default": null,
            "constraints": {
              "max_length": {
                "name": "max_blood_type_length",
                "value": 5
              }
            }
          },
          {
            "id": 11,
            "name": "is_active",
            "type": "boolean",
            "default": true,
            "constraints": {
              "nullable": false
            }
          },
          {
            "id": 12,
            "name": "registered_at",
            "type": "timestamp",
            "default": "current_timestamp",
            "constraints": {
              "nullable": false
            }
          }
        ]
      },
      {
        "id": 2,
        "name": "doctors",
        "description": "Medical staff information and specializations",
        "columns": [
          {
            "id": 1,
            "name": "id",
            "type": "serial",
            "description": "Primary key for the doctor",
            "constraints": {
              "nullable": false,
              "primary_key": true
            }
          },
          {
            "id": 2,
            "name": "license_number",
            "type": "text",
            "description": "Medical license number",
            "constraints": {
              "nullable": false,
              "unique": true,
              "min_length": {
                "name": "min_license_number_length",
                "value": 5
              },
              "max_length": {
                "name": "max_license_number_length",
                "value": 20
              }
            }
          },
          {
            "id": 3,
            "name": "first_name",
            "type": "text",
            "constraints": {
              "nullable": false,
              "min_length": {
                "name": "min_doctor_first_name_length",
                "value": 1
              },
              "max_length": {
                "name": "max_doctor_first_name_length",
                "value": 80
              }
            }
          },
          {
            "id": 4,
            "name": "last_name",
            "type": "text",
            "constraints": {
              "nullable": false,
              "max_length": {
                "name": "max_doctor_last_name_length",
                "value": 80
              }
            }
          },
          {
            "id": 5,
            "name": "specialization",
            "type": "text",
            "constraints": {
              "nullable": false,
              "min_length": {
                "name": "min_specialization_length",
                "value": 2
              },
              "max_length": {
                "name": "max_specialization_length",
                "value": 100
              }
            }
          },
          {
            "id": 6,
            "name": "phone",
            "type": "text",
            "constraints": {
              "min_length": {
                "name": "min_doctor_phone_length",
                "value": 10
              },
              "max_length": {
                "name": "max_doctor_phone_length",
                "value": 15
              }
            }
          },
          {
            "id": 7,
            "name": "office_room",
            "type": "text",
            "default": null,
            "constraints": {
              "max_length": {
                "name": "max_office_room_length",
                "value": 10
              }
            }
          },
          {
            "id": 8,
            "name": "years_experience",
            "type": "integer",
            "default": 0,
            "constraints": {
              "nullable": false,
              "min_value": {
                "name": "min_years_experience",
                "value": 0
              },
              "max_value": {
                "name": "max_years_experience",
                "value": 60
              }
            }
          },
          {
            "id": 9,
            "name": "consultation_fee_cents",
            "type": "integer",
            "constraints": {
              "nullable": false,
              "min_value": {
                "name": "min_consultation_fee",
                "value": 0
              },
              "max_value": {
                "name": "max_consultation_fee",
                "value": 100000
              }
            }
          },
          {
            "id": 10,
            "name": "is_accepting_patients",
            "type": "boolean",
            "default": true
          },
          {
            "id": 11,
            "name": "joined_at",
            "type": "date",
            "default": "current_date",
            "constraints": {
              "nullable": false
            }
          }
        ],
        "constraints": []
      },
      {
        "id": 3,
        "name": "departments",
        "description": "Hospital departments and their information",
        "columns": [
          {
            "id": 1,
            "name": "id",
            "type": "serial",
            "description": "Primary key for the department",
            "constraints": {
              "nullable": false,
              "primary_key": true
            }
          },
          {
            "id": 2,
            "name": "name",
            "type": "text",
            "description": "Department name",
            "constraints": {
              "nullable": false,
              "unique": true,
              "min_length": {
                "name": "min_department_name_length",
                "value": 2
              },
              "max_length": {
                "name": "max_department_name_length",
                "value": 100
              }
            }
          },
          {
            "id": 3,
            "name": "code",
            "type": "text",
            "constraints": {
              "nullable": false,
              "unique": true,
              "min_length": {
                "name": "min_department_code_length",
                "value": 2
              },
              "max_length": {
                "name": "max_department_code_length",
                "value": 10
              }
            }
          },
          {
            "id": 4,
            "name": "head_doctor_id",
            "type": "integer",
            "default": null
          },
          {
            "id": 5,
            "name": "floor_number",
            "type": "integer",
            "constraints": {
              "nullable": false,
              "min_value": {
                "name": "min_floor_number",
                "value": 1
              },
              "max_value": {
                "name": "max_floor_number",
                "value": 20
              }
            }
          },
          {
            "id": 6,
            "name": "extension",
            "type": "text",
            "default": null,
            "constraints": {
              "max_length": {
                "name": "max_extension_length",
                "value": 6
              }
            }
          },
          {
            "id": 7,
            "name": "budget_cents",
            "type": "integer",
            "default": 0,
            "constraints": {
              "nullable": false,
              "min_value": {
                "name": "min_budget",
                "value": 0
              }
            }
          }
        ],
        "constraints": [
          {
            "id": 1,
            "name": "fk_department_head_doctor",
            "type": "foreign_key",
            "description": "Foreign key to doctors table for department head",
            "columns": ["head_doctor_id"],
            "references": {
              "table": "doctors",
              "column": "id"
            },
            "on_delete": "set_null",
            "on_update": "cascade"
          }
        ]
      },
      {
        "id": 4,
        "name": "appointments",
        "description": "Patient appointments with doctors",
        "columns": [
          {
            "id": 1,
            "name": "id",
            "type": "serial",
            "constraints": {
              "nullable": false,
              "primary_key": true
            }
          },
          {
            "id": 2,
            "name": "patient_id",
            "type": "integer",
            "description": "Reference to patient",
            "constraints": {
              "nullable": false
            }
          },
          {
            "id": 3,
            "name": "doctor_id",
            "type": "integer",
            "description": "Reference to doctor",
            "constraints": {
              "nullable": false
            }
          },
          {
            "id": 4,
            "name": "appointment_date",
            "type": "date",
            "description": "Date of the appointment",
            "constraints": {
              "nullable": false
            }
          },
          {
            "id": 5,
            "name": "appointment_time",
            "type": "text",
            "description": "Time of appointment in HH:MM format",
            "constraints": {
              "nullable": false,
              "min_length": {
                "name": "min_appointment_time_length",
                "value": 5
              },
              "max_length": {
                "name": "max_appointment_time_length",
                "value": 8
              }
            }
          },
          {
            "id": 6,
            "name": "duration_minutes",
            "type": "integer",
            "default": 30,
            "constraints": {
              "nullable": false,
              "min_value": {
                "name": "min_duration_minutes",
                "value": 15
              },
              "max_value": {
                "name": "max_duration_minutes",
                "value": 180
              }
            }
          },
          {
            "id": 7,
            "name": "status",
            "type": "text",
            "default": "scheduled",
            "constraints": {
              "nullable": false,
              "max_length": {
                "name": "max_status_length",
                "value": 20
              }
            }
          },
          {
            "id": 8,
            "name": "notes",
            "type": "text",
            "default": null
          },
          {
            "id": 9,
            "name": "fee_charged_cents",
            "type": "integer",
            "default": null,
            "constraints": {
              "min_value": {
                "name": "min_fee_charged",
                "value": 0
              }
            }
          },
          {
            "id": 10,
            "name": "created_at",
            "type": "timestamp",
            "default": "current_timestamp"
          },
          {
            "id": 11,
            "name": "updated_at",
            "type": "timestamp",
            "default": "current_timestamp",
            "constraints": {
              "nullable": false
            }
          }
        ],
        "constraints": [
          {
            "id": 1,
            "name": "fk_appointment_patient",
            "type": "foreign_key",
            "columns": ["patient_id"],
            "references": {
              "table": "patients",
              "column": "id"
            },
            "on_delete": "cascade"
          },
          {
            "id": 2,
            "name": "fk_appointment_doctor",
            "type": "foreign_key",
            "description": "Foreign key to doctors table",
            "columns": ["doctor_id"],
            "references": {
              "table": "doctors",
              "column": "id"
            },
            "on_delete": "restrict",
            "on_update": "cascade"
          },
          {
            "id": 3,
            "name": "unique_doctor_datetime",
            "type": "unique",
            "description": "Prevent double-booking of doctors",
            "columns": ["doctor_id", "appointment_date", "appointment_time"]
          }
        ]
      },
      {
        "id": 5,
        "name": "medical_records",
        "description": "Patient medical history and treatment records",
        "columns": [
          {
            "id": 1,
            "name": "id",
            "type": "serial",
            "description": "Primary key for the medical record",
            "constraints": {
              "nullable": false,
              "primary_key": true
            }
          },
          {
            "id": 2,
            "name": "patient_id",
            "type": "integer",
            "constraints": {
              "nullable": false
            }
          },
          {
            "id": 3,
            "name": "doctor_id",
            "type": "integer",
            "constraints": {
              "nullable": false
            }
          },
          {
            "id": 4,
            "name": "visit_date",
            "type": "date",
            "default": "current_date",
            "constraints": {
              "nullable": false
            }
          },
          {
            "id": 5,
            "name": "diagnosis",
            "type": "text",
            "constraints": {
              "nullable": false,
              "min_length": {
                "name": "min_diagnosis_length",
                "value": 5
              }
            }
          },
          {
            "id": 6,
            "name": "treatment",
            "type": "text",
            "default": null
          },
          {
            "id": 7,
            "name": "prescription",
            "type": "text",
            "default": null
          },
          {
            "id": 8,
            "name": "follow_up_required",
            "type": "boolean",
            "default": false,
            "constraints": {
              "nullable": false
            }
          },
          {
            "id": 9,
            "name": "follow_up_date",
            "type": "date",
            "default": null
          },
          {
            "id": 10,
            "name": "severity_level",
            "type": "integer",
            "default": 1,
            "constraints": {
              "nullable": false,
              "min_value": {
                "name": "min_severity_level",
                "value": 1
              },
              "max_value": {
                "name": "max_severity_level",
                "value": 5
              }
            }
          }
        ],
        "constraints": [
          {
            "id": 1,
            "name": "fk_record_patient",
            "type": "foreign_key",
            "description": "Foreign key to patients table",
            "columns": ["patient_id"],
            "references": {
              "table": "patients",
              "column": "id"
            },
            "on_delete": "cascade",
            "on_update": "cascade"
          },
          {
            "id": 2,
            "name": "fk_record_doctor",
            "type": "foreign_key",
            "columns": ["doctor_id"],
            "references": {
              "table": "doctors",
              "column": "id"
            },
            "on_delete": "restrict"
          }
        ]
      }
    ]
  }
}
