{
  "database": {
    "engine": "PostgreSQL",
    "version": "15.0"
  },
  "schema": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "name": "E-commerce Platform",
    "snapshot": {
      "id": "123e4567-e89b-12d3-a456-426614174000",
      "label": "v1.0.0",
      "description": null,
      "parent_id": null,
      "created_at": "2024-01-15T10:30:00"
    },
    "tables": [
      {
        "name": "users",
        "description": "Table containing user information and authentication data",
        "columns": [
          {
            "name": "id",
            "type": "serial",
            "description": "Primary key for the user",
            "constraints": {
              "nullable": false,
              "primary_key": true
            }
          },
          {
            "name": "username",
            "type": "text",
            "description": "Unique username for login",
            "constraints": {
              "nullable": false,
              "unique": true,
              "min_length": {
                "name": "min_username_length",
                "value": 3
              },
              "max_length": {
                "name": "max_username_length",
                "value": 50
              }
            }
          },
          {
            "name": "email",
            "type": "text",
            "constraints": {
              "nullable": false,
              "unique": true,
              "max_length": {
                "name": "max_email_length",
                "value": 255
              }
            }
          },
          {
            "name": "first_name",
            "type": "text",
            "description": "User's first name",
            "constraints": {
              "nullable": false,
              "max_length": {
                "name": "max_first_name_length",
                "value": 100
              }
            }
          },
          {
            "name": "last_name",
            "type": "text",
            "constraints": {
              "nullable": false,
              "max_length": {
                "name": "max_last_name_length",
                "value": 100
              }
            }
          },
          {
            "name": "phone",
            "type": "text",
            "default": null,
            "description": "User's phone number",
            "constraints": {
              "max_length": {
                "name": "max_phone_length",
                "value": 20
              }
            }
          },
          {
            "name": "date_of_birth",
            "type": "date",
            "default": null
          },
          {
            "name": "is_active",
            "type": "boolean",
            "description": "Whether the user account is active",
            "default": true,
            "constraints": {
              "nullable": false
            }
          },
          {
            "name": "created_at",
            "type": "timestamp",
            "description": "When the user account was created",
            "default": "current_timestamp",
            "constraints": {
              "nullable": false
            }
          }
        ],
        "constraints": [
          {
            "name": "unique_full_name",
            "type": "unique",
            "description": "Ensure combination of first and last name is unique",
            "columns": ["first_name", "last_name"]
          }
        ]
      },
      {
        "name": "categories",
        "description": "Product categories for organization",
        "columns": [
          {
            "name": "id",
            "type": "serial",
            "description": "Primary key for the category",
            "constraints": {
              "nullable": false,
              "primary_key": true
            }
          },
          {
            "name": "name",
            "type": "text",
            "description": "Category name",
            "constraints": {
              "nullable": false,
              "unique": true,
              "max_length": {
                "name": "max_category_name_length",
                "value": 100
              }
            }
          },
          {
            "name": "description",
            "type": "text",
            "default": null
          },
          {
            "name": "parent_id",
            "type": "integer",
            "constraints": {
              "nullable": true
            }
          },
          {
            "name": "created_at",
            "type": "timestamp",
            "default": "current_timestamp",
            "constraints": {
              "nullable": false
            }
          }
        ],
        "constraints": [
          {
            "name": "fk_categories_parent",
            "type": "foreign_key",
            "description": "Self-referencing foreign key to create category hierarchy",
            "columns": ["parent_id"],
            "references": {
              "table": "categories",
              "column": "id"
            },
            "on_delete": "set_null",
            "on_update": "cascade"
          }
        ]
      },
      {
        "name": "products",
        "description": "Product information and inventory",
        "columns": [
          {
            "name": "id",
            "type": "serial",
            "description": "Primary key for the product",
            "constraints": {
              "nullable": false,
              "primary_key": true
            }
          },
          {
            "name": "name",
            "type": "text",
            "description": "Product name",
            "constraints": {
              "nullable": false,
              "max_length": {
                "name": "max_product_name_length",
                "value": 200
              }
            }
          },
          {
            "name": "description",
            "type": "text",
            "default": null
          },
          {
            "name": "price",
            "type": "integer",
            "description": "Product price in cents",
            "constraints": {
              "nullable": false,
              "min_value": {
                "name": "min_product_price",
                "value": 0
              }
            }
          },
          {
            "name": "category_id",
            "type": "integer",
            "constraints": {
              "nullable": false
            }
          },
          {
            "name": "stock_quantity",
            "type": "integer",
            "default": 0,
            "constraints": {
              "nullable": false,
              "min_value": {
                "name": "min_stock_quantity",
                "value": 0
              }
            }
          },
          {
            "name": "weight_grams",
            "type": "integer",
            "default": null,
            "constraints": {
              "min_value": {
                "name": "min_weight",
                "value": 1
              }
            }
          },
          {
            "name": "is_available",
            "type": "boolean",
            "description": "Whether the product is available for purchase",
            "default": true,
            "constraints": {
              "nullable": false
            }
          },
          {
            "name": "created_at",
            "type": "timestamp",
            "description": "When the product was created",
            "default": "current_timestamp",
            "constraints": {
              "nullable": false
            }
          }
        ],
        "constraints": [
          {
            "name": "fk_products_category",
            "type": "foreign_key",
            "description": "Foreign key to categories table",
            "columns": ["category_id"],
            "references": {
              "table": "categories",
              "column": "id"
            },
            "on_delete": "restrict",
            "on_update": "cascade"
          }
        ]
      },
      {
        "name": "orders",
        "description": "Customer orders and order information",
        "columns": [
          {
            "name": "id",
            "type": "serial",
            "description": "Primary key for the order",
            "constraints": {
              "nullable": false,
              "primary_key": true
            }
          },
          {
            "name": "user_id",
            "type": "integer",
            "description": "User who placed the order",
            "constraints": {
              "nullable": false
            }
          },
          {
            "name": "order_number",
            "type": "text",
            "description": "Unique order number for tracking",
            "constraints": {
              "nullable": false,
              "unique": true,
              "max_length": {
                "name": "max_order_number_length",
                "value": 50
              }
            }
          },
          {
            "name": "total_amount",
            "type": "integer",
            "description": "Total order amount in cents",
            "constraints": {
              "nullable": false,
              "min_value": {
                "name": "min_total_amount",
                "value": 0
              }
            }
          },
          {
            "name": "status",
            "type": "text",
            "description": "Order status",
            "default": "pending",
            "constraints": {
              "nullable": false,
              "max_length": {
                "name": "max_status_length",
                "value": 20
              }
            }
          },
          {
            "name": "order_date",
            "type": "timestamp",
            "description": "When the order was placed",
            "default": "current_timestamp",
            "constraints": {
              "nullable": false
            }
          },
          {
            "name": "shipped_date",
            "type": "timestamp",
            "default": null
          },
          {
            "name": "delivery_address",
            "type": "text",
            "default": null
          }
        ],
        "constraints": [
          {
            "name": "fk_orders_user",
            "type": "foreign_key",
            "description": "Foreign key to users table",
            "columns": ["user_id"],
            "references": {
              "table": "users",
              "column": "id"
            },
            "on_delete": "cascade",
            "on_update": "cascade"
          }
        ]
      },
      {
        "name": "order_items",
        "description": "Individual items within an order",
        "columns": [
          {
            "name": "id",
            "type": "serial",
            "description": "Primary key for the order item",
            "constraints": {
              "nullable": false,
              "primary_key": true
            }
          },
          {
            "name": "order_id",
            "type": "integer",
            "description": "Order this item belongs to",
            "constraints": {
              "nullable": false
            }
          },
          {
            "name": "product_id",
            "type": "integer",
            "description": "Product being ordered",
            "constraints": {
              "nullable": false
            }
          },
          {
            "name": "quantity",
            "type": "integer",
            "description": "Quantity of the product ordered",
            "constraints": {
              "nullable": false,
              "min_value": {
                "name": "min_quantity",
                "value": 1
              }
            }
          },
          {
            "name": "unit_price",
            "type": "integer",
            "description": "Price per unit at time of order in cents",
            "constraints": {
              "nullable": false,
              "min_value": {
                "name": "min_unit_price",
                "value": 0
              }
            }
          },
          {
            "name": "total_price",
            "type": "integer",
            "description": "Total price for this line item in cents",
            "constraints": {
              "nullable": false,
              "min_value": {
                "name": "min_total_price",
                "value": 0
              }
            }
          }
        ],
        "constraints": [
          {
            "name": "fk_order_items_order",
            "type": "foreign_key",
            "description": "Foreign key to orders table",
            "columns": ["order_id"],
            "references": {
              "table": "orders",
              "column": "id"
            },
            "on_delete": "cascade",
            "on_update": "cascade"
          },
          {
            "name": "fk_order_items_product",
            "type": "foreign_key",
            "description": "Foreign key to products table",
            "columns": ["product_id"],
            "references": {
              "table": "products",
              "column": "id"
            },
            "on_delete": "restrict",
            "on_update": "cascade"
          },
          {
            "name": "unique_order_product",
            "type": "unique",
            "description": "Ensure each product appears only once per order",
            "columns": ["order_id", "product_id"]
          }
        ]
      }
    ]
  }
}
