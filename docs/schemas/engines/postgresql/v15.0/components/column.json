{
  "title": "PostgreSQL Column Definition",
  "type": "object",
  "properties": {
    "id": {
      "type": "number",
      "description": "Unique local identifier for the column",
      "examples": [1, 2, 3, 4, 5]
    },
    "name": {
      "type": "string",
      "description": "Name of the column",
      "pattern": "^[a-z][a-z0-9_]*$",
      "minLength": 1,
      "maxLength": 63,
      "examples": [
        "id",
        "username",
        "email",
        "created_at",
        "supplier_code",
        "company_name",
        "credit_limit",
        "warehouse_code",
        "capacity_cubic_meters",
        "temperature_min",
        "category_code",
        "sku",
        "unit_cost_cents",
        "weight_grams",
        "length_mm",
        "shelf_life_days",
        "quantity_on_hand",
        "bin_location"
      ]
    },
    "type": {
      "type": "string",
      "description": "Data type of the column",
      "enum": ["text", "integer", "serial", "boolean", "date", "timestamp"]
    },
    "description": {
      "type": "string",
      "description": "Description of the column",
      "examples": [
        "Primary key",
        "Username of the user",
        "Email address",
        "Creation timestamp",
        "Unique supplier identification code",
        "Official company name of the supplier",
        "Maximum credit limit in cents",
        "Unique warehouse identification code",
        "Total storage capacity in cubic meters",
        "Minimum temperature in Celsius",
        "Stock Keeping Unit - unique product identifier",
        "Unit cost in cents",
        "Product weight in grams",
        "Product length in millimeters",
        "Product shelf life in days (null for non-perishable)",
        "Current quantity available",
        "Specific bin/shelf location in warehouse"
      ]
    },
    "default": {
      "type": ["string", "number", "boolean", "null"],
      "description": "Default value for the column",
      "examples": [
        12,
        "default value",
        true,
        "current_timestamp",
        "current_date",
        null
      ]
    },
    "constraints": {
      "type": "object",
      "description": "Constraints applied to the column",
      "properties": {
        "nullable": {
          "type": "boolean",
          "description": "Whether the column can be null",
          "default": true
        },
        "unique": {
          "type": "boolean",
          "description": "Whether the column must have unique values",
          "default": false
        },
        "primary_key": {
          "type": "boolean",
          "description": "Whether the column is a primary key",
          "default": false
        }
      },
      "additionalProperties": false
    }
  },
  "required": ["name", "type"],
  "allOf": [
    {
      "if": {
        "properties": {
          "type": {
            "const": "text"
          }
        }
      },
      "then": {
        "properties": {
          "constraints": {
            "properties": {
              "min_length": {
                "type": "object",
                "description": "Minimum length for text columns",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Name of the constraint",
                    "pattern": "^[a-z][a-z0-9_]*$",
                    "minLength": 1,
                    "maxLength": 63
                  },
                  "value": {
                    "type": "number",
                    "description": "Minimum length value"
                  }
                },
                "required": ["name", "value"],
                "additionalProperties": false
              },
              "max_length": {
                "type": "object",
                "description": "Maximum length for text columns",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Name of the constraint",
                    "pattern": "^[a-z][a-z0-9_]*$",
                    "minLength": 1,
                    "maxLength": 63
                  },
                  "value": {
                    "type": "number",
                    "description": "Maximum length value"
                  }
                },
                "required": ["name", "value"],
                "additionalProperties": false
              }
            }
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "type": {
            "const": "integer"
          }
        }
      },
      "then": {
        "properties": {
          "constraints": {
            "properties": {
              "min_value": {
                "type": "object",
                "description": "Minimum value for integer columns",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Name of the constraint",
                    "pattern": "^[a-z][a-z0-9_]*$",
                    "minLength": 1,
                    "maxLength": 63
                  },
                  "value": {
                    "type": "number",
                    "description": "Minimum value"
                  }
                },
                "required": ["name", "value"],
                "additionalProperties": false
              },
              "max_value": {
                "type": "object",
                "description": "Maximum value for integer columns",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Name of the constraint",
                    "pattern": "^[a-z][a-z0-9_]*$",
                    "minLength": 1,
                    "maxLength": 63
                  },
                  "value": {
                    "type": "number",
                    "description": "Maximum value"
                  }
                },
                "required": ["name", "value"],
                "additionalProperties": false
              }
            }
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "default": {
            "const": null
          }
        },
        "required": ["default"]
      },
      "then": {
        "properties": {
          "constraints": {
            "properties": {
              "nullable": false
            }
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "constraints": {
            "properties": {
              "nullable": {
                "const": false
              }
            },
            "required": ["nullable"]
          }
        }
      },
      "then": {
        "properties": {
          "default": {
            "not": {
              "const": null
            }
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "type": {
            "const": "boolean"
          }
        }
      },
      "then": {
        "properties": {
          "default": {
            "oneOf": [{ "type": "boolean" }, { "const": null }]
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "type": {
            "enum": ["integer", "serial"]
          }
        }
      },
      "then": {
        "properties": {
          "default": {
            "oneOf": [{ "type": "number" }, { "const": null }]
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "type": {
            "const": "text"
          }
        }
      },
      "then": {
        "properties": {
          "default": {
            "oneOf": [{ "type": "string" }, { "const": null }]
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "type": {
            "enum": ["date", "timestamp"]
          }
        }
      },
      "then": {
        "properties": {
          "default": {
            "oneOf": [
              {
                "type": "string",
                "enum": ["current_date", "current_timestamp"]
              },
              { "const": null }
            ]
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "type": {
            "const": "serial"
          }
        }
      },
      "then": {
        "properties": {
          "default": false,
          "constraints": {
            "properties": {
              "nullable": false,
              "unique": false
            }
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "constraints": {
            "properties": {
              "primary_key": {
                "const": true
              }
            },
            "required": ["primary_key"]
          }
        }
      },
      "then": {
        "properties": {
          "constraints": {
            "properties": {
              "nullable": false,
              "unique": false
            }
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "constraints": {
            "properties": {
              "nullable": {
                "const": true
              }
            },
            "required": ["nullable"]
          }
        }
      },
      "then": {
        "properties": {
          "type": {
            "not": {
              "const": "serial"
            }
          },
          "constraints": {
            "properties": {
              "primary_key": false
            }
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "constraints": {
            "properties": {
              "unique": {
                "const": true
              }
            },
            "required": ["unique"]
          }
        }
      },
      "then": {
        "properties": {
          "type": {
            "not": {
              "const": "serial"
            }
          },
          "constraints": {
            "properties": {
              "primary_key": false
            }
          }
        }
      }
    }
  ],
  "additionalProperties": false
}
